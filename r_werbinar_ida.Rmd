--- 
title: "IDA Introduktion til R"
author: "Tue Hellstern"
date: "`r Sys.Date()`"
site: bookdown::bookdown_site
output: bookdown::gitbook
documentclass: book
bibliography: [book.bib, packages.bib]
biblio-style: apalike
link-citations: yes
github-repo: rstudio/bookdown-demo
description: "Webinar i R programmering i R"
---

# Webinar

* Webinar den 22-04-2020
* Kl. 19:00
* Tue Hellstern
* Jelgreen Consult

Dette webinar er udviklet af Tue Hellstern i samarbejde med Jelgreen Consult.

Dette materiale må ikke kopieres eller mangfoldiggøres uden forudgående aftale med Jelgren Consult.

![](img/jelgreen.png)


## Filer
Det er følgende filer der bruges på dette webinar:

**R kode filer**

* webinar.R


**Data filer**

* webinar_data.xlsx - *Indeholder tre ark;  height_weight, issalg og salgs_data*
* bmi.csv
* issalg.csv
* salgs_data.csv


<!--chapter:end:index.Rmd-->

# Introduktion {#intro}

<!--chapter:end:01-introduktion.Rmd-->

# R og RStudio {#R_RStudio}

Du skal have installeret R og det IDE udviklingsmiljø, der hedder RStudio, begge er open source og begge findes til Mac, Linux og Windows.

## R
Du skal downloade R fra 
<a href="https://cran.r-project.org" target="_blank">https://cran.r-project.org</a> 
Du skal her vælge den version, der passer til din computer – Linux, OS X (Mac) eller Windows.
Der er vejledninger for de forskellige installationer på www siden.

## RStudio
Når R er installeret, kan du bruge det, men for at gøre det nemmere bruger vi et udviklingsmiljø, der hedder RStudio. Rstudio findes i flere forskellige versioner, den du skal bruge er *RStudio Desktop Open Source License* 

Som du finder her: <a href="https://www.rstudio.com/products/rstudio/download/" target="_blank">https://www.rstudio.com/products/rstudio/download/</a> 
Du skal her vælge den version, der passer til din computer.

![](img/rstudio_editor.png)

<!--chapter:end:02-RStudio.Rmd-->

# Grundlæggende R {#grund}
Som alle andre programmeringssprog har R nogle forskellige regler for, hvordan koden skal bygges op – altså syntaksen for R.

## Navne
”Navne” i R skal overholde nogle regler:

* Bogstaver – a til z – store og små. Du kan ikke bruge de danske tegn æøå
* Tal
* Tegnene ”.” og ”_”. Altså ikke mellemrum eller bindestreg
* Et navn kan ikke starte med et Tal, men skal starte med et bogstav eller et gyldigt tegn
* R er case-sensitiv. Der er forskel på store og små bogstaver

## Variable / Objekter
Alt hvad du kommer til at bruge i R vil blive gemt i Objekter, det kan være et enkelt tal eller et helt datasæt. 
I R skal du bruge ”<-” for at gemme en værdi i et objekt. Mange andre programmeringssprog bruger her ”=”.

```
2 + 2                 # Beregn
1:100                 # printer 1 til 100
print("Hej med dig")

x <- 2                # Tildel x værdien 2
x * 2
x * x
x + x
x                     # Viser værdien af x

y <- c(6, 7, 8, 9, 10) # Gemmer 6 til 10 i variablen y
# c() står for concatenate eller combine - Giver en vektor

x + y   # x lagt sammen med y
y
x * 2  # Ganger alle elementer i x med 2 - LOOP uden at være et LOOP ?

ls()   # Vis / List alle objekter
```


## Funktioner
R har de sammen funktioner som du måske kender fra Excel eller andre programeringssprog

```
length(y)     # Antallet af numre i vektoren
min(y)        # Minimumsværdien
max(y)        # Maksimumværdien
median(y)     # Medianen
sum(y)        # Summen
mean(y)       # Gennemsnittet
var(y)        # Variansen
sd(y)         # Standardafvigelsen
```


## Logiske operatorer
Meget af det du kommer til at arbejde med i R, vil kræve en eller anden form for logisk operator. Med en logisk operator finder du ud af om et udsagn er Sandt eller Falsk.

```
x == 2        # "==" betyder "lig med"
x != 2        # "!=" betyder "ikke lig med"
x < 1         # "<" betyder "mindre end"
x > 1         # ">" betyder "større end"
x <= 2        # "<=" betyder "mindre eller lig med
```

*Husk, at dette også gælder for de mapper, du arbejder med.*

## Hjælp
Du kan få hjælp direkte i R ved at bruge nedstående kommandoer:

```
help("mean") # Hjælp til en specifik funktion - mean
help("plot")

?mean 
?plot

# Hjælp til en specifik pakke - base og tidyverse
help(package = "base")
help(package = "tidyverse")
```

Hjælpen vises i vinduet nederst til højre

## Working Directory
R bruger en mappe som ”Working folder”. Det er nemmere at tilgå filer, der ligger i denne mappe.

```
getwd()
setwd("C:/Users/Tue Hellstern/Documents/GitHub/r_webinar/r_kode/webinar_dag1")
```




<!--chapter:end:03-grund.Rmd-->

# Pakker {#pakker}
Du kan ”tilføje” funknationalitet til R ved at installere forskellige pakker. Du kan nederst til højre se, hvilke pakker du har installeret.
Det er også her muligt at opdatere de pakker, du har installeret.
Du kan finde en oversigt over de forskellige pakker her: <a href="https://cran.rstudio.com" target="_blank">cran.rstudio.com</a>

## Installation af pakker
Du kan installere pakker på to måder:

* Via RStudio - GUI
* Via R kode


### Grafisk
I vinduet nederst til højre kan du klikke på fanen **Packages** og derefter på knappen **Install**, du skriver navnet på den eller de pakker du vil installere.

![Pakker](img/pakker.png)

Det er også muligt at opdatere dine pakker vi knappen **Update**

I sammme vindue kan du også se hvilke pakker der er i *brug*.

### Kode
Det er nemt at installere og bruge pakker via kode:

```
library()                     # Pakker der er på din computer
install.packages("ggplot2")   # install
library(dplyr)                # load

update.packages("tidyverse")  # Update
remove.packages("tidyverse")  # Fjern
```




<!--chapter:end:04-pakker.Rmd-->

# Data {#data}
For at arbejde med data skal de importeres ind i R. Det er simpelt, hvis de filer der skal importeres ligger i R’s aktive bibliotek. Det er en god ide at organisere dine data inden de importeres, hvilket der findes mange gode værktøjer til.

R kan importere fra de fleste formater, her vil jeg bruge; **CSV** og **Excel**

Du kan i RStudio vælge mellem at bruge den grafiske brugerflade (GUI) eller skrive den kode, du vil bruge til importen. 

## Grafisk (GUI)
Fordelen ved at bruge den grafiske brugerflade er, at du ikke skal huske de forskellige importfunktioner. Det ligner lidt det at importere data i f.eks. Excel.

**Import af fra Excel**

Når du vil importere data fra en Excel fil, kan du bruge: File > Import Dataset > From Excel
Derefter vælger du den Excel fil, du vil importere 


## Kode

<!--chapter:end:05-data.Rmd-->

﻿# Plots {#plots}

## Standard plot

```
category <- table(salg$CategoryName)
str(category)
barplot(category[order(category, decreasing = T)])
```

Giver dette plot

``` {r}
library(readxl)
salg <- read_excel("webinar_data.xlsx", sheet = "salgs_data") 
category <- table(salg$CategoryName)
str(category)
barplot(category[order(category, decreasing = T)])
```


## ggplot2

```
ggplot(data=issalg) +
  geom_point(mapping = aes(x=Temperatur, y=Salg, color=Butik_Placering, size=Salg)) +
  geom_smooth(mapping = aes(x=Temperatur, y=Salg, color=Butik_Placering), se=FALSE) +
  geom_hline(yintercept = mean(issalg$Salg)) +
  geom_vline(xintercept = mean(issalg$Temperatur)) +
  annotate("text", label="Middel temperatur", y=1, x=mean(issalg$Temperatur+4)) +
  theme(panel.background = element_blank()) +
  theme(plot.background = element_blank()) +
  scale_x_continuous(name="Temperatur") +
  scale_y_continuous(name="Total Salg") +
  scale_color_discrete(name="Placering af butiken") +
  scale_size_continuous(name="Salg")
```
Giver dette plot

```{r}
library(ggplot2)
library(readxl)
issalg <- read_excel("webinar_data.xlsx", sheet = "issalg")

ggplot(data=issalg) +
  geom_point(mapping = aes(x=Temperatur, y=Salg, color=Butik_Placering, size=Salg)) +
  geom_smooth(mapping = aes(x=Temperatur, y=Salg, color=Butik_Placering), se=FALSE) +
  geom_hline(yintercept = mean(issalg$Salg)) +
  geom_vline(xintercept = mean(issalg$Temperatur)) +
  annotate("text", label="Middel temperatur", y=1, x=mean(issalg$Temperatur+4)) +
  theme(panel.background = element_blank()) +
  theme(plot.background = element_blank()) +
  scale_x_continuous(name="Temperatur") +
  scale_y_continuous(name="Total Salg") +
  scale_color_discrete(name="Placering af butiken") +
  scale_size_continuous(name="Salg")
```


<!--chapter:end:06-plot.Rmd-->

# Demo Shiny {#shiny}
Når du har lavet en ”analyse” i R vil et tit være en fordel at kunne dele denne med andre, det kan du gøre ved at sende den dit R script og data, men det er nok ikke den mest brugervenlige måde.
En anden ulighed er vise det på en webside så det kan tilgås via en browser. Det kan du opnå via en R pakke der hedder shiny.
Du kan finde en del eksempler på løsninger oprettet i shiny her: <a href="https://shiny.rstudio.com/gallery/#demos" target="_blank">shiny.rstudio.com/gallery/#demos</a>

Det er også muligt at afvikle de 11 eksempler der følger med shiny på følgende måde:

```
# Shiny eksempler
runExample("01_hello")
runExample("02_text")
runExample("03_reactivity")
runExample("04_mpg")
runExample("05_sliders")
runExample("06_tabsets")
runExample("07_widgets")
runExample("08_html")
runExample("09_upload")
runExample("10_download")
runExample("11_timer")
```

## Struktur af en Shiny app
En Shimy App er ”samlet” i et enkelt script app.R som du kan afvikle.
app.R består af tre dele:

* Userinterface (ui.R) - *Her styrer du layout af din applikation*
* Server (server.R) - *Her definere du det der skal til for at opbygge din løsning*
* Kald til shinyApp function - *Her bygges selev løsningen*

Du kan oprette en ny shiny App under: 
**File – New File – Shiny Web App**
I dette vindue skal du indtaste navnet på din App og placeringen. Du har også mulighed for at vælge mellem og din App skal opdeles i to file, **ui.R** og **server.R**, eller om du vil have alt i en fil. 

Opdelingen i to filer giver dig de fleste muligheder og en bedre kontrol.

Du får to filer der indeholder en demo løsning som du kan bruge som 
udgangspunkt for din egen løsning.


<!--chapter:end:07-demoshiny.Rmd-->

# Cheatsheets {#cheatsheets}

* RStudio Cheatsheets - <a href="https://rstudio.com/resources/cheatsheets/" target="_blank">rstudio.com/resources/cheatsheets/</a>
* <a href="https://github.com/rstudio/cheatsheets/raw/master/rstudio-ide.pdf" target="_blank">RStudio IDE</a>
* <a href="https://github.com/rstudio/cheatsheets/raw/master/data-import.pdf" target="_blank">readr</a>
* <a href="https://github.com/rstudio/cheatsheets/raw/master/data-transformation.pdf" target="_blank">dplyr</a>
* <a href="https://github.com/rstudio/cheatsheets/raw/master/shiny.pdf" target="_blank">Shiny</a>
* <a href="https://github.com/rstudio/cheatsheets/raw/master/data-visualization-2.1.pdf" target="_blank">ggplot2</a>




# Links {#links}
Her er en lille samling af nyttige links, det er på ingen måde en fuldstændig liste – Brug <a href="https://www.google.com" target="_blank">Google</a>.

* <a href="https://www.rproject.org" target="_blank">www.rproject.org</a> 
* <a href="https://mran.microsoft.com/open" target="_blank">mran.microsoft.com/open</a> 
* <a href="https://www.rstudio.com" target="_blank">www.rstudio.com</a> 
* <a href="https://support.rstudio.com/hc/en-us/categories/200035113-Documentation" target="_blank">support.rstudio.com/hc/en-us/categories/200035113-Documentation</a>
* <a href="https://community.rstudio.com/" target="_blank">community.rstudio.com</a>
* <a href="https://www.statmethods.net" target="_blank">www.statmethods.net</a> 







<!--chapter:end:08-links.Rmd-->

